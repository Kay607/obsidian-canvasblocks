<!--
![Obsidian Downloads](https://img.shields.io/badge/dynamic/json?logo=obsidian&color=%23483699&label=downloads&query=%24%5B%22{{ pluginID }}%22%5D.downloads&url=https%3A%2F%2Fraw.githubusercontent.com%2Fobsidianmd%2Fobsidian-releases%2Fmaster%2Fcommunity-plugin-stats.json)
-->

# Canvas Blocks

Integrate python snippets with Obsidian Canvas.

Select a script node and run the command `Canvas Blocks: Execute Canvas Command` to execute it

Overlap a script node with another node to use it as input to the script

Use edges for additional parameters by pointing the arrow into the script node

## Usage
![QRCodeExample](https://github.com/Kay607/obsidian-canvasblocks/assets/54263177/fe01115b-3b0a-449e-b09b-1c8ec78a4334)

![ResizeExample](https://github.com/Kay607/obsidian-canvasblocks/assets/54263177/6a768dcb-96c3-4d84-bde0-8538bc88010a)

Scripts can either be written as a text node in canvas or in a markdown file

The code is inside of a code block using the language `pycanvasblock`

```pycanvasblock
file = get_parameter_file("r")
text = file.read()
file.close()

file = get_parameter_file("w")
file.write(text.upper())
file.close()
```

### Examples
Example scripts can be found at [Examples](examples)

## Writing Scripts

The plugin exposes several variables to the script to allow it to process parameters. All node data is provided in the [JSON Canvas](https://jsoncanvas.org/) format used by Obsidian Canvas in the form of python objects

`script_data` A copy of the script being executed is provided

`parameter_data` The node data of the parameter node (the node which overlaps with the script in the canvas). If none is overlapping, this will be `{}`

`arrow_parameters` An list containing all nodes with an edge pointing into the script

`vault_path` The absolute path to the root directory of the vault

`plugin_folder` A local path from the vault root. This is set in the settings but defaults to `Assets/CanvasBlocks`. This can be used for storing data generated by scripts

`has_parameter` A boolean value for whether there is a parameter node (only considers overlapping nodes, not ones linked by edges)

---

As well as this, the plugin contains a library for useful functions to interface with the canvas such as these and more

`install_dependency`

`create_text_node`

`create_file_node`

For more information on this, read the provided library at [Canvas Blocks Python Library](resources/canvasblocks-python-lib.py)


## Installation

<!-- Recommended to install from the Obsidian community store. -->

You can manually install this using the [BRAT](https://github.com/TfTHacker/obsidian42-brat) Obsidian plugin. Generic installation instructions are available on that plugin's documentation.

## Contribution

Feel free to create an [issue](https://github.com/Kay607/obsidian-canvasblocks/issues) or [pull request](https://github.com/Kay607/obsidian-canvasblocks/pulls)

### Building

Requires npm to be installed

`git clone https://github.com/Kay607/obsidian-canvasblocks --recursive` Clone the repository into the `.obsidian/plugins` folder

`npm i` Install modules

`npm run dev` Builds the plugin when a change is made

